[서비스 플로우 설명]

[사진, 목소리 저장 경로 설정]
우선 파일의 저장 경로는 skrrrrr 폴더에 /uploads 폴더를 생성해 ({file.upload-dir}활용)
첫번째 uploads 폴더 안에서 child, parent로 나눠
두번째 각 폴더 안에서 childId, ParentId 값으로 나눠
세번째 각 id 폴더 안에서 picture, voice로 폴더를 나눠
네번째 각 사진,목소리 폴더 안에서 "parentId_chat1(숫자 1씩 증가).mp3", "{childId}_picture_{UUID}.확장자" 등 이런식으로 저장이 되게 하고 싶어.

[사진, 목소리 저장 및 학습 플로우]
자녀 회원가입시 사진은 자녀가 자신의 사진을 불러와서 저장하는거고, 목소리는 회원가입시 녹음을 진행해서 저장하는거야.
그리고 부모 회원가입시에도 사용자가 부모 사진을 직접 불러와서 저장하는거야.

부모의 목소리는 부모가 챗봇과 음성대화를 직접 하는 순간에 자동으로 음성을 녹음해서 저장하는 형태야.
예를 들면 챗봇이 "밥 드셨어요? 오늘 점심은 어떤거예요?" 라고 질문을 했어.
부모는 답변할 때 "나는 오늘 점심에 카레를 먹었어." 라고하고 대답을 끝냈어.
이때 "나는 오늘 점심에 카레를 먹었어."가 하나의 채팅(chat1)인거야.

그리고 부모의 목소리는 이 채팅별로 음성파일이 저장돼.
파일명은 "{parentId}_chat1(숫자 1씩 증가).mp3" 이런 형태로 작성되게 할거야. 확장자는 mp3로 하고 싶어.

그래서 /parent/parentId/voice 이렇게 폴더를 생성해서
parentId 폴더 안에 "parentId_chat1(숫자 1씩 증가).mp3" 이 형태의 파일명을 가진 파일 저장이 되는거야.
그리고 하나의 ParentId당 저장되는 음성 파일의 갯수는 chat1 ~ chat30까지 저장이 되면 더 이상 저장을 하지 않는거지.

chat 30까지 저장을 하고 나면 이 30개의 목소리 녹음 파일로 ai에게 부모의 목소리를 시켜서 자서전을 읽어주는 목소리에 적용하고 싶어.
학습이 완료된 parentId 폴더는 압축을 해서 parent 폴더 내부에 압축파일로 저장을 하고 압축되지 않은 parentId 폴더는 삭제를 해서 데이터 용량을 정리하고 싶어.

목소리와 사진을 학습하는 곳은 signup_complete 페이지에서 "서비스 시작하기" 버튼을 누르면 이미지 학습과 목소리 학습 단계를 거쳐서 db에 저장하고
저장이 완료되고 나면 메인페이지로 이동해.
이때 부모의 사진 학습, 자녀의 사진 학습, 자녀의 목소리 학습에 쓰이는 프롬프트(prompt)는 다 달라.
부모의 목소리를 학습하는 공간은 자서전 페이지에서 자서전 생성하기 버튼을 누르면 그때 부모의 학습된 목소리, 부모의 학습된 이미지를 활용하여 자서전이 만들어져.

그러면 챗봇의 케릭터는 자녀의 이미지를 학습해서 만들어낸 걸로 바로 나타나고, 챗복의 목소리는 자녀의 목소리를 학습해서 나온 목소리로 자동설정이 돼.
부모 사진을 학습한 건 부모의 자서전 첫 표지에 쓰이는 이미지를 만들어낼때 사용해.

학습된 파일(목소리, 이미지)의 저장 경로도 똑같이 각자 고유 Id 폴더 안에 voice와 picture 폴더 안에 저장이 될건데
ai와 일반 원본을 구분하기 쉽게 학습된 파일들은 파일명을 또 다르게 하는게 좋을 것 같아.
"ai_{childId}_picture_{UUID}.확장자 / ai_{parentId}_voice_{UUID}.mp3" 이런식으로

[로그인 플로우]
자녀는 소셜 계정 로그인(현재는 카카오 로그인만 연동, 추후 네이버, 구글 연동 예정)을 통해서 로그인을 하거나, 회원가입시 추가 입력했던 서비스 자체 아이디와 비밀번호를 이용해서 로그인 할 수 있어. 2가지의 방법으로 로그인을 할 수 있어

부모는 자녀의 페이지에 생성된 인증코드(숫자 8개로 이루어짐)만 입력하면 바로 로그인할 수 있어.
이 인증코드는 일정 시간마다 (유효시간 3분 예정) 만료되고 새롭게 생성되게 만들어주려고 해.
그래서 자녀의 마이페이지에서 인증코드 버튼을 들어가면 부모용 로그인 인증코드가 발급이 돼. 거기에 떠있는 인증코드를 입력하면 로그인 성공!

지금은 이정도가 로그인 플로우야

[로그아웃 플로우]
마이페이지의 로그아웃 버튼을 누르면 로그아웃이 되도록 설계하고 싶어 (아직 로그아웃 기능 구현 안됨)

[회원탈퇴 플로우]
마이페이지 제일 하단에 회원 탈퇴 기능을 만들고 그 버튼을 누르면 회원 탈퇴시 서비스 이용이 중지 된다는 내용과 자녀와 부모가 둘다 회원 탈퇴를 진행하게 되면 지금까지 쌓여있던 데이터가 전부 초기화 된다는 경고 페이지를 띄워줄거야.
 그리고 그 페이지에서 회원 탈퇴하기 버튼을 클릭하면 한 번 더 알럿(alert)창이 떠서 경고를 하고 탈퇴하겠다고 하면 그때 30일간 데이터를 보존한 뒤 (state = INACTIVE로 변경) 31일째 되는 날에 데이터를 전부 지워주면 좋겠어.
회원 탈퇴는 부모 따로, 자녀 따로 가능하고 데이터는 부모와 자녀가 둘 다 삭제했을 경우에만 삭제되었으면 좋겠어. link로 부모와 자녀가 연결은 되어있지만 연결이 끊겨도 ChildId 또는 ParentId 값 만으로 데이터가 보존이 되었으면 좋겠어.

이 플로우를 실제로 구현이 가능하도록 전체 코드(생략 없이)를 작성 해주면돼.
팀원들이 각자 맡은 생성형 AI 기능을 직접 작성해서 넣을 수 있게 각각 생성형 AI 로직을 써야하는 부분은 따로 만들어줘.
생성형 로직을 넣는 부분을 따로 파일을 만들어도 좋을 것 같아. 그 파일을 불러오는 식으로 하면 되니까!

각 파일의 전체 코드를 보내줄 때는 만들어야하는 순서대로 보여주면 되는데, 파일의 코드는 하나씩만 보여줘.
보여준 파일을 내가 완료했다고 말하면 그 때 그 다음 순서의 파일의 전체 코드를 보내주면 돼.

이미 내가 만들어 놓은 파일들이 있으니까 필요한 파일이 있으면 알려줘.
그 파일이 어떻게 구성되어 있는지 알려줄게.
 